# Guest Image Customization For Perfomance Usecases

## Description
The prepare_performance_images play performs the following tasks:
- Prepares repos for RHEL/CentOS images (internal use only)
- Clones Trex from upstream repo to guest image
- Clones DPDK from upstream repo and compiles it

**Note!** - virt_customize moduless are planned to be shipped in this repo until they're available in PyPI
**Note!** - Inventory file is required, generated by `playbooks/tripleo/post_install/tripleo_inventory.yml`

* Repos
    * Fetches rhos-release tool from internal sources to generate repos for RHEL/CentOS images
* Prepare Tres
    * Clones Trex binaries from repo
* Prepare DPDK
    * Clones DPDK binaries from repo
    * Compiles DPDK binaries

## Run triggers
* prepare_trex - Executed if 'true'. False by default.
* prepare_dpdk - Executed if 'true'. False by default.

## Role variables
#### Image details
- guest_image - Path of image to be customized on underclound node
#### Binaries versions
- dpdk_version - DPDK version to be cloned, [Default: 'v17.05'].
- trex_version - Trex version to be cloned, [Default: 'v2.43'].

***
## Examples
The examples of running the playbook:

```Installing DPDK inside guest image"
ansible-playbook playbooks/images/prepare_performance_images.yml -e guest_image-'/path/to/image' -e prepare_dpdk=True
```

```Installing Trex inside guest image"
ansible-playbook playbooks/images/prepare_performance_images.yml -e guest_image-'/path/to/image' -e prepare_trex=True
```
