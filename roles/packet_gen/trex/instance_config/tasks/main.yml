- name: Parse Configuration From Instance
  block:
  - name: Query Trex Instance If No External Configuration Is Passed
    include_tasks: query_trex_instance.yaml
    delegate_to: undercloud

  - name: Generate Variables For Trex Conf From Trex Instance
    include_tasks: populate_trex_conf.yaml
  when: gather_trex_conf_live

- name: Create trex_cfg.yaml file
  template:
    src: trex_cfg.yaml.j2
    dest: /etc/trex_cfg.yaml
  become: True