{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6f016e01_1ce8df18",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 129,
      "author": {
        "id": 1007976
      },
      "writtenOn": "2023-09-15T16:19:21Z",
      "side": 1,
      "message": "wondering dpdk2 is part of a bridge  and used in bonding. I am not sure it can be used separately like this. is this working?",
      "range": {
        "startLine": 125,
        "startChar": 0,
        "endLine": 129,
        "endChar": 35
      },
      "revId": "e69ba19b05d6dc2b6822651176e7aabc73bdd36a",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cf5e3cd7_5e3bc572",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 129,
      "author": {
        "id": 1019727
      },
      "writtenOn": "2023-09-15T16:35:01Z",
      "side": 1,
      "message": "Essentially we are testing the same thing. Previous to this change we had this:\n~~~\npmd_rxq_affinity:\n  - interface: \"dpdk2\"\n    pmd_rxq_affinity: \"0:3,1:5,2:7\"\n  - interface: \"dpdk3\"\n    pmd_rxq_affinity: \"0:3,1:5,2:7\"\n~~~\n    \nand this:\n~~~\n- type: ovs_user_bridge\n  name: br-dpdk0\n  mtu: 9000\n  use_dhcp: false\n  members:\n    - type: ovs_dpdk_port\n      name: dpdk2\n      mtu: 9000\n      rx_queue: 3\n      members:\n        - type: interface\n          name: nic5\n\n- type: ovs_user_bridge\n  name: br-dpdk1\n  mtu: 9000\n  use_dhcp: false\n  members:\n    - type: ovs_dpdk_port\n      name: dpdk3\n      mtu: 9000\n      rx_queue: 3\n      members:\n        - type: interface\n          name: nic6\n~~~\n          \nBut if we have this:\n~~~\n- type: ovs_user_bridge\n  name: br-dpdk0\n  mtu: 9000\n  use_dhcp: false\n  members:\n  - type: ovs_dpdk_bond\n    name: dpdkbond1\n    mtu: 9000\n    rx_queue: 3\n    members:\n      - type: ovs_dpdk_port\n        name: dpdk2\n        members:\n          - type: interface\n            name: nic5\n      - type: ovs_dpdk_port\n        name: dpdk3\n        members:\n          - type: interface\n            name: nic6\n\n- type: ovs_user_bridge\n  name: br-dpdk1\n  mtu: 9000\n  use_dhcp: false\n  members:\n    - type: ovs_dpdk_port\n      name: dpdk4\n      mtu: 9000\n      rx_queue: 3\n      members:\n\t- type: interface\n          name: nic4\n~~~\n\nThere is not differences in br-dpdk1 except for nic4 instead of nic6 used. And br-dpdk0 is also the same from the point of view of the traffic received because one of the interfaces of the bond (dpdk3) will be down all traffic will be handled by dpdk2.",
      "parentUuid": "6f016e01_1ce8df18",
      "range": {
        "startLine": 125,
        "startChar": 0,
        "endLine": 129,
        "endChar": 35
      },
      "revId": "e69ba19b05d6dc2b6822651176e7aabc73bdd36a",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "86c1fade_03defad1",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 129,
      "author": {
        "id": 1019727
      },
      "writtenOn": "2023-09-15T16:36:37Z",
      "side": 1,
      "message": "Also we need this:\n~~~\npmd_rxq_affinity:\n  - interface: \"dpdk2\"\n    pmd_rxq_affinity: \"0:3,1:5,2:7\"\n  - interface: \"dpdk4\"\n    pmd_rxq_affinity: \"0:3,1:5,2:7\"\n~~~",
      "parentUuid": "cf5e3cd7_5e3bc572",
      "range": {
        "startLine": 125,
        "startChar": 0,
        "endLine": 129,
        "endChar": 35
      },
      "revId": "e69ba19b05d6dc2b6822651176e7aabc73bdd36a",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "554bfaf8_145c6d91",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1016373
      },
      "writtenOn": "2023-09-18T09:06:06Z",
      "side": 1,
      "message": "I would not modify the configuration of the system for this. I think it is easier to just configure switch ports.",
      "revId": "e69ba19b05d6dc2b6822651176e7aabc73bdd36a",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "59a30bf0_7916c9f7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1019727
      },
      "writtenOn": "2023-09-18T09:31:36Z",
      "side": 1,
      "message": "Why do you thing it\u0027s easier to modify the switch ports? I do not agree because you\u0027ll need to use the switch playbooks. However, doing this way we only to add a task to the MQ learning playbook. And from the point of view of the MQ discovery testing is equivalent. Anyway, this change does not set up any interface by default, only gives you the possibility of doing it.",
      "parentUuid": "554bfaf8_145c6d91",
      "revId": "e69ba19b05d6dc2b6822651176e7aabc73bdd36a",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4558fb08_50fc2015",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1016373
      },
      "writtenOn": "2023-09-18T10:02:08Z",
      "side": 1,
      "message": "You are receiving traffic in both dpdk2, dpdk3 because the switch does not know that both interfaces belong to a bonding. So, in order not to receive traffic duplicated you need to configure a bond in the switch. You can configure lacp too, so, traffic will be sent only through the active interface.\nI think this is a more realistic solution\nThe only thing to resolve is that you will need to configure pmd_rxq_affinity in both of the ports of the switch, because you do dont know which is active, or you configure the bond and look for the active one\nI think that with switch configuration it is not needed to create any code, just configuration",
      "parentUuid": "59a30bf0_7916c9f7",
      "revId": "e69ba19b05d6dc2b6822651176e7aabc73bdd36a",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "99e09943_6164d9da",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1018675
      },
      "writtenOn": "2023-09-20T13:54:25Z",
      "side": 1,
      "message": "I think taking down an interface like this might be problematic but lets run it for a certain time and see if it works consistently",
      "revId": "e69ba19b05d6dc2b6822651176e7aabc73bdd36a",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ],
  "submitRequirementResults": []
}