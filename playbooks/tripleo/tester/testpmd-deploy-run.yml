---

- name: Prepare compute host
  hosts: compute
  roles:
   - post_install/compute_tasks
  become: True
  become_method: sudo
  become_user: root

- name: Prepare the environment
  hosts: undercloud
  vars:
    boot_instance: true
    group_name: testpmd
  roles:
   - post_install/openstack_tasks
  become: True
  become_method: sudo
  become_user: root

- name: Prepare the environment
  hosts: testpmd
  roles:
    - tester/testpmd_install
  become: True
  become_method: sudo
  become_user: root

- name: Run TestPMD
  hosts: testpmd
  roles:
    - tester/testpmd_run
  become: True

- name: MoonGen run
  hosts: moongen
  roles:
    - packet_gen/moongen/run
